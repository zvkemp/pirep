import*as e from"codemirror";import*as t from"codemirror/addon/edit/continuelist.js";import*as a from"codemirror/addon/display/fullscreen.js";import*as o from"codemirror/mode/markdown/markdown.js";import*as i from"codemirror/addon/mode/overlay.js";import*as r from"codemirror/addon/display/placeholder.js";import*as n from"codemirror/addon/display/autorefresh.js";import*as s from"codemirror/addon/selection/mark-selection.js";import*as l from"codemirror/addon/search/searchcursor.js";import*as d from"codemirror/mode/gfm/gfm.js";import*as c from"codemirror/mode/xml/xml.js";import*as g from"codemirror-spell-checker";import*as u from"marked/lib/marked";var p="default"in e?e.default:e;var m=p;m.commands.tabAndIndentMarkdownList=function(e){var t=e.listSelections();var a=t[0].head;var o=e.getStateAfter(a.line);var i=false!==o.list;if(i)e.execCommand("indentMore");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var r=Array(e.options.tabSize+1).join(" ");e.replaceSelection(r)}};m.commands.shiftTabAndUnindentMarkdownList=function(e){var t=e.listSelections();var a=t[0].head;var o=e.getStateAfter(a.line);var i=false!==o.list;if(i)e.execCommand("indentLess");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var r=Array(e.options.tabSize+1).join(" ");e.replaceSelection(r)}};var f={};var v="default"in e?e.default:e;var h="default"in t?t.default:t;var y="default"in a?a.default:a;var b="default"in o?o.default:o;var E="default"in i?i.default:i;var S="default"in r?r.default:r;var w="default"in n?n.default:n;var k="default"in s?s.default:s;var C="default"in l?l.default:l;var M="default"in d?d.default:d;var x="default"in c?c.default:c;var T="default"in g?g.default:g;var H="default"in u?u.default:u;var I={};var D=v;h;f;y;b;E;S;w;k;C;M;x;var B=T;var N=H;var _=/Mac/.test(navigator.platform);var L=new RegExp(/(<a.*?https?:\/\/.*?[^a]>)+?/g);var A={toggleBold:toggleBold,toggleItalic:toggleItalic,drawLink:drawLink,toggleHeadingSmaller:toggleHeadingSmaller,toggleHeadingBigger:toggleHeadingBigger,drawImage:drawImage,toggleBlockquote:toggleBlockquote,toggleOrderedList:toggleOrderedList,toggleUnorderedList:toggleUnorderedList,toggleCodeBlock:toggleCodeBlock,togglePreview:togglePreview,toggleStrikethrough:toggleStrikethrough,toggleHeading1:toggleHeading1,toggleHeading2:toggleHeading2,toggleHeading3:toggleHeading3,cleanBlock:cleanBlock,drawTable:drawTable,drawHorizontalRule:drawHorizontalRule,undo:undo,redo:redo,toggleSideBySide:toggleSideBySide,toggleFullScreen:toggleFullScreen};var F={toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeadingSmaller:"Cmd-H",toggleHeadingBigger:"Shift-Cmd-H",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleBlockquote:"Cmd-'",toggleOrderedList:"Cmd-Alt-L",toggleUnorderedList:"Cmd-L",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11"};var getBindingName=function(e){for(var t in A)if(A[t]===e)return t;return null};var isMobile=function(){var e=false;(function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4)))&&(e=true)})(navigator.userAgent||navigator.vendor||window.opera);return e};
/**
 * Modify HTML to add 'target="_blank"' to links so they open in new tabs by default.
 * @param {string} htmlText - HTML to be modified.
 * @return {string} The modified HTML text.
 */function addAnchorTargetBlank(e){var t;while(null!==(t=L.exec(e))){var a=t[0];if(-1===a.indexOf("target=")){var o=a.replace(/>$/,' target="_blank">');e=e.replace(a,o)}}return e}
/**
 * Modify HTML to remove the list-style when rendering checkboxes.
 * @param {string} htmlText - HTML to be modified.
 * @return {string} The modified HTML text.
 */function removeListStyleWhenCheckbox(e){var t=new DOMParser;var a=t.parseFromString(e,"text/html");var o=a.getElementsByTagName("li");for(var i=0;i<o.length;i++){var r=o[i];for(var n=0;n<r.children.length;n++){var s=r.children[n];if(s instanceof HTMLInputElement&&"checkbox"===s.type){r.style.marginLeft="-1.5em";r.style.listStyleType="none"}}}return a.documentElement.innerHTML}function fixShortcut(e){e=_?e.replace("Ctrl","Cmd"):e.replace("Cmd","Ctrl");return e}var z={};
/**
 * Convert a className string into a regex for matching (and cache).
 * Note that the RegExp includes trailing spaces for replacement
 * (to ensure that removing a class from the middle of the string will retain
 *  spacing between other classes.)
 * @param {String} className Class name to convert to regex for matching.
 * @returns {RegExp} Regular expression option that will match className.
 */function getClassRegex(e){return z[e]||(z[e]=new RegExp("\\s*"+e+"(\\s*)","g"))}
/**
 * Add a class string to an element.
 * @param {Element} el DOM element on which to add className.
 * @param {String} className Class string to apply
 * @returns {void}
 */function addClass(e,t){if(e&&t){var a=getClassRegex(t);e.className.match(a)||(e.className+=" "+t)}}
/**
 * Remove a class string from an element.
 * @param {Element} el DOM element from which to remove className.
 * @param {String} className Class string to remove
 * @returns {void}
 */function removeClass(e,t){if(e&&t){var a=getClassRegex(t);e.className.match(a)&&(e.className=e.className.replace(a,"$1"))}}function createToolbarDropdown(e,t,a,o){var i=createToolbarButton(e,false,t,a,"button",o);i.className+=" easymde-dropdown";var r=document.createElement("div");r.className="easymde-dropdown-content";for(var n=0;n<e.children.length;n++){var s=e.children[n];var l;l=createToolbarButton("string"===typeof s&&s in U?U[s]:s,true,t,a,"button",o);r.appendChild(l)}i.appendChild(r);return i}function createToolbarButton(e,t,a,o,i,r){e=e||{};var n=document.createElement(i);n.className=e.name;n.setAttribute("type",i);a=void 0==a||a;e.name&&e.name in o&&(A[e.name]=e.action);if(e.title&&a){n.title=createTooltip(e.title,e.action,o);if(_){n.title=n.title.replace("Ctrl","⌘");n.title=n.title.replace("Alt","⌥")}}e.noDisable&&n.classList.add("no-disable");e.noMobile&&n.classList.add("no-mobile");var s=[];"undefined"!==typeof e.className&&(s=e.className.split(" "));var l=[];for(var d=0;d<s.length;d++){var c=s[d];c.match(/^fa([srlb]|(-[\w-]*)|$)/)?l.push(c):n.classList.add(c)}n.tabIndex=-1;var g=document.createElement("i");for(var u=0;u<l.length;u++){var p=l[u];g.classList.add(p)}n.appendChild(g);"undefined"!==typeof e.icon&&(n.innerHTML=e.icon);e.action&&t&&("function"===typeof e.action?n.onclick=function(t){t.preventDefault();e.action(r)}:"string"===typeof e.action&&(n.onclick=function(t){t.preventDefault();window.open(e.action,"_blank")}));return n}function createSep(){var e=document.createElement("i");e.className="separator";e.innerHTML="|";return e}function createTooltip(e,t,a){var o;var i=e;if(t){o=getBindingName(t);a[o]&&(i+=" ("+fixShortcut(a[o])+")")}return i}function getState(e,t){t=t||e.getCursor("start");var a=e.getTokenAt(t);if(!a.type)return{};var o=a.type.split(" ");var i,r,n={};for(var s=0;s<o.length;s++){i=o[s];if("strong"===i)n.bold=true;else if("variable-2"===i){r=e.getLine(t.line);/^\s*\d+\.\s/.test(r)?n["ordered-list"]=true:n["unordered-list"]=true}else"atom"===i?n.quote=true:"em"===i?n.italic=true:"quote"===i?n.quote=true:"strikethrough"===i?n.strikethrough=true:"comment"===i?n.code=true:"link"===i?n.link=true:"tag"===i?n.image=true:i.match(/^header(-[1-6])?$/)&&(n[i.replace("header","heading")]=true)}return n}var O="";function toggleFullScreen(e){var t=e.codemirror;t.setOption("fullScreen",!t.getOption("fullScreen"));if(t.getOption("fullScreen")){O=document.body.style.overflow;document.body.style.overflow="hidden"}else document.body.style.overflow=O;var a=t.getWrapperElement();var o=a.nextSibling;if(/editor-preview-active-side/.test(o.className))if(false===e.options.sideBySideFullscreen){var i=a.parentNode;t.getOption("fullScreen")?removeClass(i,"sided--no-fullscreen"):addClass(i,"sided--no-fullscreen")}else toggleSideBySide(e);e.options.onToggleFullScreen&&e.options.onToggleFullScreen(t.getOption("fullScreen")||false);if("undefined"!==typeof e.options.maxHeight)if(t.getOption("fullScreen")){t.getScrollerElement().style.removeProperty("height");o.style.removeProperty("height")}else{t.getScrollerElement().style.height=e.options.maxHeight;e.setPreviewMaxHeight()}/fullscreen/.test(e.toolbar_div.className)?e.toolbar_div.className=e.toolbar_div.className.replace(/\s*fullscreen\b/,""):e.toolbar_div.className+=" fullscreen";if(e.toolbarElements&&e.toolbarElements.fullscreen){var r=e.toolbarElements.fullscreen;/active/.test(r.className)?r.className=r.className.replace(/\s*active\s*/g,""):r.className+=" active"}}function toggleBold(e){_toggleBlock(e,"bold",e.options.blockStyles.bold)}function toggleItalic(e){_toggleBlock(e,"italic",e.options.blockStyles.italic)}function toggleStrikethrough(e){_toggleBlock(e,"strikethrough","~~")}function toggleCodeBlock(e){var t=e.options.blockStyles.code;function fencing_line(e){if("object"!==typeof e)throw"fencing_line() takes a 'line' object (not a line number, or line text).  Got: "+typeof e+": "+e;return e.styles&&e.styles[2]&&-1!==e.styles[2].indexOf("formatting-code-block")}function token_state(e){return e.state.base.base||e.state.base}function code_type(e,t,a,o,i){a=a||e.getLineHandle(t);o=o||e.getTokenAt({line:t,ch:1});i=i||!!a.text&&e.getTokenAt({line:t,ch:a.text.length-1});var r=o.type?o.type.split(" "):[];return i&&token_state(i).indentedCode?"indented":-1!==r.indexOf("comment")&&(token_state(o).fencedChars||token_state(i).fencedChars||fencing_line(a)?"fenced":"single")}function insertFencingAtSelection(e,t,a,o){var i=t.line+1,r=a.line+1,n=t.line!==a.line,s=o+"\n",l="\n"+o;n&&r++;if(n&&0===a.ch){l=o+"\n";r--}_replaceSelection(e,false,[s,l]);e.setSelection({line:i,ch:0},{line:r,ch:0})}var a=e.codemirror,o=a.getCursor("start"),i=a.getCursor("end"),r=a.getTokenAt({line:o.line,ch:o.ch||1}),n=a.getLineHandle(o.line),s=code_type(a,o.line,n,r);var l,d,c;if("single"===s){var g=n.text.slice(0,o.ch).replace("`",""),u=n.text.slice(o.ch).replace("`","");a.replaceRange(g+u,{line:o.line,ch:0},{line:o.line,ch:99999999999999});o.ch--;o!==i&&i.ch--;a.setSelection(o,i);a.focus()}else if("fenced"===s)if(o.line!==i.line||o.ch!==i.ch){for(l=o.line;l>=0;l--){n=a.getLineHandle(l);if(fencing_line(n))break}var p=a.getTokenAt({line:l,ch:1});var m=token_state(p).fencedChars;var f,v;var h,y;if(fencing_line(a.getLineHandle(o.line))){f="";v=o.line}else if(fencing_line(a.getLineHandle(o.line-1))){f="";v=o.line-1}else{f=m+"\n";v=o.line}if(fencing_line(a.getLineHandle(i.line))){h="";y=i.line;0===i.ch&&(y+=1)}else if(0!==i.ch&&fencing_line(a.getLineHandle(i.line+1))){h="";y=i.line+1}else{h=m+"\n";y=i.line+1}0===i.ch&&(y-=1);a.operation((function(){a.replaceRange(h,{line:y,ch:0},{line:y+(h?0:1),ch:0});a.replaceRange(f,{line:v,ch:0},{line:v+(f?0:1),ch:0})}));a.setSelection({line:v+(f?1:0),ch:0},{line:y+(f?1:-1),ch:0});a.focus()}else{var b=o.line;if(fencing_line(a.getLineHandle(o.line)))if("fenced"===code_type(a,o.line+1)){l=o.line;b=o.line+1}else{d=o.line;b=o.line-1}if(void 0===l)for(l=b;l>=0;l--){n=a.getLineHandle(l);if(fencing_line(n))break}if(void 0===d){c=a.lineCount();for(d=b;d<c;d++){n=a.getLineHandle(d);if(fencing_line(n))break}}a.operation((function(){a.replaceRange("",{line:l,ch:0},{line:l+1,ch:0});a.replaceRange("",{line:d-1,ch:0},{line:d,ch:0})}));a.focus()}else if("indented"===s){if(o.line!==i.line||o.ch!==i.ch){l=o.line;d=i.line;0===i.ch&&d--}else{for(l=o.line;l>=0;l--){n=a.getLineHandle(l);if(!n.text.match(/^\s*$/)&&"indented"!==code_type(a,l,n)){l+=1;break}}c=a.lineCount();for(d=o.line;d<c;d++){n=a.getLineHandle(d);if(!n.text.match(/^\s*$/)&&"indented"!==code_type(a,d,n)){d-=1;break}}}var E=a.getLineHandle(d+1),S=E&&a.getTokenAt({line:d+1,ch:E.text.length-1}),w=S&&token_state(S).indentedCode;w&&a.replaceRange("\n",{line:d+1,ch:0});for(var k=l;k<=d;k++)a.indentLine(k,"subtract");a.focus()}else{var C=o.line===i.line&&o.ch===i.ch&&0===o.ch;var M=o.line!==i.line;C||M?insertFencingAtSelection(a,o,i,t):_replaceSelection(a,false,["`","`"])}}function toggleBlockquote(e){var t=e.codemirror;_toggleLine(t,"quote")}function toggleHeadingSmaller(e){var t=e.codemirror;_toggleHeading(t,"smaller")}function toggleHeadingBigger(e){var t=e.codemirror;_toggleHeading(t,"bigger")}function toggleHeading1(e){var t=e.codemirror;_toggleHeading(t,void 0,1)}function toggleHeading2(e){var t=e.codemirror;_toggleHeading(t,void 0,2)}function toggleHeading3(e){var t=e.codemirror;_toggleHeading(t,void 0,3)}function toggleUnorderedList(e){var t=e.codemirror;_toggleLine(t,"unordered-list")}function toggleOrderedList(e){var t=e.codemirror;_toggleLine(t,"ordered-list")}function cleanBlock(e){var t=e.codemirror;_cleanBlock(t)}function drawLink(e){var t=e.codemirror;var a=getState(t);var o=e.options;var i="https://";if(o.promptURLs){i=prompt(o.promptTexts.link,"https://");if(!i)return false}_replaceSelection(t,a.link,o.insertTexts.link,i)}function drawImage(e){var t=e.codemirror;var a=getState(t);var o=e.options;var i="https://";if(o.promptURLs){i=prompt(o.promptTexts.image,"https://");if(!i)return false}_replaceSelection(t,a.image,o.insertTexts.image,i)}
/**
 * Action for opening the browse-file window to upload an image to a server.
 * @param editor {EasyMDE} The EasyMDE object
 */function drawUploadedImage(e){e.openBrowseFileWindow()}
/**
 * Action executed after an image have been successfully imported on the server.
 * @param editor {EasyMDE} The EasyMDE object
 * @param url {string} The url of the uploaded image
 */function afterImageUploaded(e,t){var a=e.codemirror;var o=getState(a);var i=e.options;var r=t.substr(t.lastIndexOf("/")+1);var n=r.substring(r.lastIndexOf(".")+1).replace(/\?.*$/,"");if(["png","jpg","jpeg","gif","svg"].includes(n))_replaceSelection(a,o.image,i.insertTexts.uploadedImage,t);else{var s=i.insertTexts.link;s[0]="["+r;_replaceSelection(a,o.link,s,t)}e.updateStatusBar("upload-image",e.options.imageTexts.sbOnUploaded.replace("#image_name#",r));setTimeout((function(){e.updateStatusBar("upload-image",e.options.imageTexts.sbInit)}),1e3)}function drawTable(e){var t=e.codemirror;var a=getState(t);var o=e.options;_replaceSelection(t,a.table,o.insertTexts.table)}function drawHorizontalRule(e){var t=e.codemirror;var a=getState(t);var o=e.options;_replaceSelection(t,a.image,o.insertTexts.horizontalRule)}function undo(e){var t=e.codemirror;t.undo();t.focus()}function redo(e){var t=e.codemirror;t.redo();t.focus()}function toggleSideBySide(e){var t=e.codemirror;var a=t.getWrapperElement();var o=a.nextSibling;var i=e.toolbarElements&&e.toolbarElements["side-by-side"];var r=false;var n=a.parentNode;if(/editor-preview-active-side/.test(o.className)){false===e.options.sideBySideFullscreen&&removeClass(n,"sided--no-fullscreen");o.className=o.className.replace(/\s*editor-preview-active-side\s*/g,"");i&&(i.className=i.className.replace(/\s*active\s*/g,""));a.className=a.className.replace(/\s*CodeMirror-sided\s*/g," ")}else{setTimeout((function(){t.getOption("fullScreen")||(false===e.options.sideBySideFullscreen?addClass(n,"sided--no-fullscreen"):toggleFullScreen(e));o.className+=" editor-preview-active-side"}),1);i&&(i.className+=" active");a.className+=" CodeMirror-sided";r=true}var s=a.lastChild;if(/editor-preview-active/.test(s.className)){s.className=s.className.replace(/\s*editor-preview-active\s*/g,"");var l=e.toolbarElements.preview;var d=e.toolbar_div;l.className=l.className.replace(/\s*active\s*/g,"");d.className=d.className.replace(/\s*disabled-for-preview*/g,"")}var sideBySideRenderingFunction=function(){var t=e.options.previewRender(e.value(),o);null!=t&&(o.innerHTML=t)};t.sideBySideRenderingFunction||(t.sideBySideRenderingFunction=sideBySideRenderingFunction);if(r){var c=e.options.previewRender(e.value(),o);null!=c&&(o.innerHTML=c);t.on("update",t.sideBySideRenderingFunction)}else t.off("update",t.sideBySideRenderingFunction);t.refresh()}function togglePreview(e){var t=e.codemirror;var a=t.getWrapperElement();var o=e.toolbar_div;var i=!!e.options.toolbar&&e.toolbarElements.preview;var r=a.lastChild;var n=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(n.className)&&toggleSideBySide(e);if(!r||!/editor-preview-full/.test(r.className)){r=document.createElement("div");r.className="editor-preview-full";if(e.options.previewClass)if(Array.isArray(e.options.previewClass))for(var s=0;s<e.options.previewClass.length;s++)r.className+=" "+e.options.previewClass[s];else"string"===typeof e.options.previewClass&&(r.className+=" "+e.options.previewClass);a.appendChild(r)}if(/editor-preview-active/.test(r.className)){r.className=r.className.replace(/\s*editor-preview-active\s*/g,"");if(i){i.className=i.className.replace(/\s*active\s*/g,"");o.className=o.className.replace(/\s*disabled-for-preview*/g,"")}}else{setTimeout((function(){r.className+=" editor-preview-active"}),1);if(i){i.className+=" active";o.className+=" disabled-for-preview"}}r.innerHTML=e.options.previewRender(e.value(),r)}function _replaceSelection(e,t,a,o){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var i;var r=a[0];var n=a[1];var s={},l={};Object.assign(s,e.getCursor("start"));Object.assign(l,e.getCursor("end"));if(o){r=r.replace("#url#",o);n=n.replace("#url#",o)}if(t){i=e.getLine(s.line);r=i.slice(0,s.ch);n=i.slice(s.ch);e.replaceRange(r+n,{line:s.line,ch:0})}else{i=e.getSelection();e.replaceSelection(r+i+n);s.ch+=r.length;s!==l&&(l.ch+=r.length)}e.setSelection(s,l);e.focus()}}function _toggleHeading(e,t,a){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var o=e.getCursor("start");var i=e.getCursor("end");for(var r=o.line;r<=i.line;r++)(function(o){var i=e.getLine(o);var r=i.search(/[^#]/);i=void 0!==t?r<=0?"bigger"==t?"###### "+i:"# "+i:6==r&&"smaller"==t?i.substr(7):1==r&&"bigger"==t?i.substr(2):"bigger"==t?i.substr(1):"#"+i:1==a?r<=0?"# "+i:r==a?i.substr(r+1):"# "+i.substr(r+1):2==a?r<=0?"## "+i:r==a?i.substr(r+1):"## "+i.substr(r+1):r<=0?"### "+i:r==a?i.substr(r+1):"### "+i.substr(r+1);e.replaceRange(i,{line:o,ch:0},{line:o,ch:99999999999999})})(r);e.focus()}}function _toggleLine(e,t){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var a=/^(\s*)(\*|-|\+|\d*\.)(\s+)/;var o=/^\s*/;var i=getState(e);var r=e.getCursor("start");var n=e.getCursor("end");var s={quote:/^(\s*)>\s+/,"unordered-list":a,"ordered-list":a};var _getChar=function(e,t){var a={quote:">","unordered-list":"*","ordered-list":"%%i."};return a[e].replace("%%i",t)};var _checkChar=function(e,t){var a={quote:">","unordered-list":"*","ordered-list":"\\d+."};var o=new RegExp(a[e]);return t&&o.test(t)};var _toggle=function(e,t,i){var r=a.exec(t);var n=_getChar(e,l);if(null!==r){_checkChar(e,r[2])&&(n="");t=r[1]+n+r[3]+t.replace(o,"").replace(s[e],"$1")}else false==i&&(t=n+" "+t);return t};var l=1;for(var d=r.line;d<=n.line;d++)(function(a){var o=e.getLine(a);if(i[t])o=o.replace(s[t],"$1");else{"unordered-list"==t&&(o=_toggle("ordered-list",o,true));o=_toggle(t,o,false);l+=1}e.replaceRange(o,{line:a,ch:0},{line:a,ch:99999999999999})})(d);e.focus()}}function _toggleBlock(e,t,a,o){if(!/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className)){o="undefined"===typeof o?a:o;var i=e.codemirror;var r=getState(i);var n;var s=a;var l=o;var d=i.getCursor("start");var c=i.getCursor("end");if(r[t]){n=i.getLine(d.line);s=n.slice(0,d.ch);l=n.slice(d.ch);if("bold"==t){s=s.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,"");l=l.replace(/(\*\*|__)/,"")}else if("italic"==t){s=s.replace(/(\*|_)(?![\s\S]*(\*|_))/,"");l=l.replace(/(\*|_)/,"")}else if("strikethrough"==t){s=s.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,"");l=l.replace(/(\*\*|~~)/,"")}i.replaceRange(s+l,{line:d.line,ch:0},{line:d.line,ch:99999999999999});if("bold"==t||"strikethrough"==t){d.ch-=2;d!==c&&(c.ch-=2)}else if("italic"==t){d.ch-=1;d!==c&&(c.ch-=1)}}else{n=i.getSelection();if("bold"==t){n=n.split("**").join("");n=n.split("__").join("")}else if("italic"==t){n=n.split("*").join("");n=n.split("_").join("")}else"strikethrough"==t&&(n=n.split("~~").join(""));i.replaceSelection(s+n+l);d.ch+=a.length;c.ch=d.ch+n.length}i.setSelection(d,c);i.focus()}}function _cleanBlock(e){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var t=e.getCursor("start");var a=e.getCursor("end");var o;for(var i=t.line;i<=a.line;i++){o=e.getLine(i);o=o.replace(/^[ ]*([# ]+|\*|-|[> ]+|[0-9]+(.|\)))[ ]*/,"");e.replaceRange(o,{line:i,ch:0},{line:i,ch:99999999999999})}}}
/**
 * Convert a number of bytes to a human-readable file size. If you desire
 * to add a space between the value and the unit, you need to add this space
 * to the given units.
 * @param bytes {integer} A number of bytes, as integer. Ex: 421137
 * @param units {number[]} An array of human-readable units, ie. [' B', ' K', ' MB']
 * @returns string A human-readable file size. Ex: '412 KB'
 */function humanFileSize(e,t){if(Math.abs(e)<1024)return""+e+t[0];var a=0;do{e/=1024;++a}while(Math.abs(e)>=1024&&a<t.length);return""+e.toFixed(1)+t[a]}function _mergeProperties(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]instanceof Array?e[a]=t[a].concat(e[a]instanceof Array?e[a]:[]):null!==t[a]&&"object"===typeof t[a]&&t[a].constructor===Object?e[a]=_mergeProperties(e[a]||{},t[a]):e[a]=t[a]);return e}function extend(e){for(var t=1;t<arguments.length;t++)e=_mergeProperties(e,arguments[t]);return e}function wordCount(e){var t=/[a-zA-Z0-9_\u00A0-\u02AF\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g;var a=e.match(t);var o=0;if(null===a)return o;for(var i=0;i<a.length;i++)a[i].charCodeAt(0)>=19968?o+=a[i].length:o+=1;return o}var U={bold:{name:"bold",action:toggleBold,className:"fa fa-bold",title:"Bold",default:true},italic:{name:"italic",action:toggleItalic,className:"fa fa-italic",title:"Italic",default:true},strikethrough:{name:"strikethrough",action:toggleStrikethrough,className:"fa fa-strikethrough",title:"Strikethrough"},heading:{name:"heading",action:toggleHeadingSmaller,className:"fa fa-header fa-heading",title:"Heading",default:true},"heading-smaller":{name:"heading-smaller",action:toggleHeadingSmaller,className:"fa fa-header fa-heading header-smaller",title:"Smaller Heading"},"heading-bigger":{name:"heading-bigger",action:toggleHeadingBigger,className:"fa fa-header fa-heading header-bigger",title:"Bigger Heading"},"heading-1":{name:"heading-1",action:toggleHeading1,className:"fa fa-header fa-heading header-1",title:"Big Heading"},"heading-2":{name:"heading-2",action:toggleHeading2,className:"fa fa-header fa-heading header-2",title:"Medium Heading"},"heading-3":{name:"heading-3",action:toggleHeading3,className:"fa fa-header fa-heading header-3",title:"Small Heading"},"separator-1":{name:"separator-1"},code:{name:"code",action:toggleCodeBlock,className:"fa fa-code",title:"Code"},quote:{name:"quote",action:toggleBlockquote,className:"fa fa-quote-left",title:"Quote",default:true},"unordered-list":{name:"unordered-list",action:toggleUnorderedList,className:"fa fa-list-ul",title:"Generic List",default:true},"ordered-list":{name:"ordered-list",action:toggleOrderedList,className:"fa fa-list-ol",title:"Numbered List",default:true},"clean-block":{name:"clean-block",action:cleanBlock,className:"fa fa-eraser",title:"Clean block"},"separator-2":{name:"separator-2"},link:{name:"link",action:drawLink,className:"fa fa-link",title:"Create Link",default:true},image:{name:"image",action:drawImage,className:"fa fa-image",title:"Insert Image",default:true},"upload-image":{name:"upload-image",action:drawUploadedImage,className:"fa fa-image",title:"Import an image"},table:{name:"table",action:drawTable,className:"fa fa-table",title:"Insert Table"},"horizontal-rule":{name:"horizontal-rule",action:drawHorizontalRule,className:"fa fa-minus",title:"Insert Horizontal Line"},"separator-3":{name:"separator-3"},preview:{name:"preview",action:togglePreview,className:"fa fa-eye",noDisable:true,title:"Toggle Preview",default:true},"side-by-side":{name:"side-by-side",action:toggleSideBySide,className:"fa fa-columns",noDisable:true,noMobile:true,title:"Toggle Side by Side",default:true},fullscreen:{name:"fullscreen",action:toggleFullScreen,className:"fa fa-arrows-alt",noDisable:true,noMobile:true,title:"Toggle Fullscreen",default:true},"separator-4":{name:"separator-4"},guide:{name:"guide",action:"https://www.markdownguide.org/basic-syntax/",className:"fa fa-question-circle",noDisable:true,title:"Markdown Guide",default:true},"separator-5":{name:"separator-5"},undo:{name:"undo",action:undo,className:"fa fa-undo",noDisable:true,title:"Undo"},redo:{name:"redo",action:redo,className:"fa fa-repeat fa-redo",noDisable:true,title:"Redo"}};var R={link:["[","](#url#)"],image:["![](","#url#)"],uploadedImage:["![](#url#)",""],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text     | Text     |\n\n"],horizontalRule:["","\n\n-----\n\n"]};var q={link:"URL for the link:",image:"URL of the image:"};var j={locale:"en-US",format:{hour:"2-digit",minute:"2-digit"}};var P={bold:"**",code:"```",italic:"*"};var W={sbInit:"Attach files by drag and dropping or pasting from clipboard.",sbOnDragEnter:"Drop image to upload it.",sbOnDrop:"Uploading image #images_names#...",sbProgress:"Uploading #file_name#: #progress#%",sbOnUploaded:"Uploaded #image_name#",sizeUnits:" B, KB, MB"};var V={noFileGiven:"You must select a file.",typeNotAllowed:"This image type is not allowed.",fileTooLarge:"Image #image_name# is too big (#image_size#).\nMaximum file size is #image_max_size#.",importError:"Something went wrong when uploading the image #image_name#."};function EasyMDE(e){e=e||{};e.parent=this;var t=true;false===e.autoDownloadFontAwesome&&(t=false);if(true!==e.autoDownloadFontAwesome){var a=document.styleSheets;for(var o=0;o<a.length;o++)a[o].href&&a[o].href.indexOf("//maxcdn.bootstrapcdn.com/font-awesome/")>-1&&(t=false)}if(t){var i=document.createElement("link");i.rel="stylesheet";i.href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css";document.getElementsByTagName("head")[0].appendChild(i)}if(e.element)this.element=e.element;else if(null===e.element){console.log("EasyMDE: Error. No element was found.");return}if(void 0===e.toolbar){e.toolbar=[];for(var r in U)if(Object.prototype.hasOwnProperty.call(U,r)){-1!=r.indexOf("separator-")&&e.toolbar.push("|");(true===U[r].default||e.showIcons&&e.showIcons.constructor===Array&&-1!=e.showIcons.indexOf(r))&&e.toolbar.push(r)}}Object.prototype.hasOwnProperty.call(e,"previewClass")||(e.previewClass="editor-preview");if(!Object.prototype.hasOwnProperty.call(e,"status")){e.status=["autosave","lines","words","cursor"];e.uploadImage&&e.status.unshift("upload-image")}e.previewRender||(e.previewRender=function(e){return this.parent.markdown(e)});e.parsingConfig=extend({highlightFormatting:true},e.parsingConfig||{});e.insertTexts=extend({},R,e.insertTexts||{});e.promptTexts=extend({},q,e.promptTexts||{});e.blockStyles=extend({},P,e.blockStyles||{});void 0!=e.autosave&&(e.autosave.timeFormat=extend({},j,e.autosave.timeFormat||{}));e.shortcuts=extend({},F,e.shortcuts||{});e.maxHeight=e.maxHeight||void 0;"undefined"!==typeof e.maxHeight?e.minHeight=e.maxHeight:e.minHeight=e.minHeight||"300px";e.errorCallback=e.errorCallback||function(e){alert(e)};e.uploadImage=e.uploadImage||false;e.imageMaxSize=e.imageMaxSize||2097152;e.imageAccept=e.imageAccept||"image/png, image/jpeg";e.imageTexts=extend({},W,e.imageTexts||{});e.errorMessages=extend({},V,e.errorMessages||{});void 0!=e.autosave&&void 0!=e.autosave.unique_id&&""!=e.autosave.unique_id&&(e.autosave.uniqueId=e.autosave.unique_id);e.overlayMode&&void 0===e.overlayMode.combine&&(e.overlayMode.combine=true);this.options=e;this.render();!e.initialValue||this.options.autosave&&true===this.options.autosave.foundSavedValue||this.value(e.initialValue);if(e.uploadImage){var n=this;this.codemirror.on("dragenter",(function(e,t){n.updateStatusBar("upload-image",n.options.imageTexts.sbOnDragEnter);t.stopPropagation();t.preventDefault()}));this.codemirror.on("dragend",(function(e,t){n.updateStatusBar("upload-image",n.options.imageTexts.sbInit);t.stopPropagation();t.preventDefault()}));this.codemirror.on("dragleave",(function(e,t){n.updateStatusBar("upload-image",n.options.imageTexts.sbInit);t.stopPropagation();t.preventDefault()}));this.codemirror.on("dragover",(function(e,t){n.updateStatusBar("upload-image",n.options.imageTexts.sbOnDragEnter);t.stopPropagation();t.preventDefault()}));this.codemirror.on("drop",(function(t,a){a.stopPropagation();a.preventDefault();e.imageUploadFunction?n.uploadImagesUsingCustomFunction(e.imageUploadFunction,a.dataTransfer.files):n.uploadImages(a.dataTransfer.files)}));this.codemirror.on("paste",(function(t,a){e.imageUploadFunction?n.uploadImagesUsingCustomFunction(e.imageUploadFunction,a.clipboardData.files):n.uploadImages(a.clipboardData.files)}))}}
/**
 * Upload asynchronously a list of images to a server.
 *
 * Can be triggered by:
 * - drag&drop;
 * - copy-paste;
 * - the browse-file window (opened when the user clicks on the *upload-image* icon).
 * @param {FileList} files The files to upload the the server.
 * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage
 * @param [onError] {function} see EasyMDE.prototype.uploadImage
 */EasyMDE.prototype.uploadImages=function(e,t,a){if(0!==e.length){var o=[];for(var i=0;i<e.length;i++){o.push(e[i].name);this.uploadImage(e[i],t,a)}this.updateStatusBar("upload-image",this.options.imageTexts.sbOnDrop.replace("#images_names#",o.join(", ")))}};
/**
 * Upload asynchronously a list of images to a server.
 *
 * Can be triggered by:
 * - drag&drop;
 * - copy-paste;
 * - the browse-file window (opened when the user clicks on the *upload-image* icon).
 * @param imageUploadFunction {Function} The custom function to upload the image passed in options.
 * @param {FileList} files The files to upload the the server.
 */EasyMDE.prototype.uploadImagesUsingCustomFunction=function(e,t){if(0!==t.length){var a=[];for(var o=0;o<t.length;o++){a.push(t[o].name);this.uploadImageUsingCustomFunction(e,t[o])}this.updateStatusBar("upload-image",this.options.imageTexts.sbOnDrop.replace("#images_names#",a.join(", ")))}};
/**
 * Update an item in the status bar.
 * @param itemName {string} The name of the item to update (ie. 'upload-image', 'autosave', etc.).
 * @param content {string} the new content of the item to write in the status bar.
 */EasyMDE.prototype.updateStatusBar=function(e,t){if(this.gui.statusbar){var a=this.gui.statusbar.getElementsByClassName(e);1===a.length?this.gui.statusbar.getElementsByClassName(e)[0].textContent=t:0===a.length?console.log("EasyMDE: status bar item "+e+" was not found."):console.log("EasyMDE: Several status bar items named "+e+" was found.")}};EasyMDE.prototype.markdown=function(e){if(N){var t;t=this.options&&this.options.renderingConfig&&this.options.renderingConfig.markedOptions?this.options.renderingConfig.markedOptions:{};this.options&&this.options.renderingConfig&&false===this.options.renderingConfig.singleLineBreaks?t.breaks=false:t.breaks=true;if(this.options&&this.options.renderingConfig&&true===this.options.renderingConfig.codeSyntaxHighlighting){var a=this.options.renderingConfig.hljs||window.hljs;a&&(t.highlight=function(e,t){return t&&a.getLanguage(t)?a.highlight(t,e).value:a.highlightAuto(e).value})}N.setOptions(t);var o=N(e);this.options.renderingConfig&&"function"===typeof this.options.renderingConfig.sanitizerFunction&&(o=this.options.renderingConfig.sanitizerFunction.call(this,o));o=addAnchorTargetBlank(o);o=removeListStyleWhenCheckbox(o);return o}};EasyMDE.prototype.render=function(e){e||(e=this.element||document.getElementsByTagName("textarea")[0]);if(!this._rendered||this._rendered!==e){this.element=e;var t=this.options;var a=this;var o={};for(var i in t.shortcuts)null!==t.shortcuts[i]&&null!==A[i]&&function(e){o[fixShortcut(t.shortcuts[e])]=function(){var t=A[e];"function"===typeof t?t(a):"string"===typeof t&&window.open(t,"_blank")}}(i);o.Enter="newlineAndIndentContinueMarkdownList";o.Tab="tabAndIndentMarkdownList";o["Shift-Tab"]="shiftTabAndUnindentMarkdownList";o.Esc=function(e){e.getOption("fullScreen")&&toggleFullScreen(a)};this.documentOnKeyDown=function(e){e=e||window.event;27==e.keyCode&&a.codemirror.getOption("fullScreen")&&toggleFullScreen(a)};document.addEventListener("keydown",this.documentOnKeyDown,false);var r,n;if(t.overlayMode){D.defineMode("overlay-mode",(function(e){return D.overlayMode(D.getMode(e,false!==t.spellChecker?"spell-checker":"gfm"),t.overlayMode.mode,t.overlayMode.combine)}));r="overlay-mode";n=t.parsingConfig;n.gitHubSpice=false}else{r=t.parsingConfig;r.name="gfm";r.gitHubSpice=false}if(false!==t.spellChecker){r="spell-checker";n=t.parsingConfig;n.name="gfm";n.gitHubSpice=false;B({codeMirrorInstance:D})}this.codemirror=D.fromTextArea(e,{mode:r,backdrop:n,theme:void 0!=t.theme?t.theme:"easymde",tabSize:void 0!=t.tabSize?t.tabSize:2,indentUnit:void 0!=t.tabSize?t.tabSize:2,indentWithTabs:false!==t.indentWithTabs,lineNumbers:true===t.lineNumbers,autofocus:true===t.autofocus,extraKeys:o,lineWrapping:false!==t.lineWrapping,allowDropFileTypes:["text/plain"],placeholder:t.placeholder||e.getAttribute("placeholder")||"",styleSelectedText:void 0!=t.styleSelectedText?t.styleSelectedText:!isMobile(),scrollbarStyle:void 0!=t.scrollbarStyle?t.scrollbarStyle:"native",configureMouse:configureMouse,inputStyle:void 0!=t.inputStyle?t.inputStyle:isMobile()?"contenteditable":"textarea",spellcheck:void 0==t.nativeSpellcheck||t.nativeSpellcheck,autoRefresh:void 0!=t.autoRefresh&&t.autoRefresh});this.codemirror.getScrollerElement().style.minHeight=t.minHeight;"undefined"!==typeof t.maxHeight&&(this.codemirror.getScrollerElement().style.height=t.maxHeight);if(true===t.forceSync){var s=this.codemirror;s.on("change",(function(){s.save()}))}this.gui={};var l=document.createElement("div");l.classList.add("EasyMDEContainer");var d=this.codemirror.getWrapperElement();d.parentNode.insertBefore(l,d);l.appendChild(d);false!==t.toolbar&&(this.gui.toolbar=this.createToolbar());false!==t.status&&(this.gui.statusbar=this.createStatusbar());if(void 0!=t.autosave&&true===t.autosave.enabled){this.autosave();this.codemirror.on("change",(function(){clearTimeout(a._autosave_timeout);a._autosave_timeout=setTimeout((function(){a.autosave()}),a.options.autosave.submit_delay||a.options.autosave.delay||1e3)}))}var c=this;this.codemirror.on("update",(function(){handleImages()}));this.gui.sideBySide=this.createSideBySide();this._rendered=this.element;var g=this.codemirror;setTimeout(function(){g.refresh()}.bind(g),0)}function configureMouse(e,t,a){return{addNew:false}}function calcHeight(e,t){var a;var o=window.getComputedStyle(document.querySelector(".CodeMirror-sizer")).width.replace("px","");a=e<o?t+"px":t/e*100+"%";return a}function assignImageBlockAttributes(e,t){e.setAttribute("data-img-src",t.url);e.setAttribute("style","--bg-image:url("+t.url+");--width:"+t.naturalWidth+"px;--height:"+calcHeight(t.naturalWidth,t.naturalHeight));c.codemirror.setSize()}function handleImages(){t.previewImagesInEditor&&l.querySelectorAll(".cm-image-marker").forEach((function(e){var t=e.parentElement;if(t.innerText.match(/^!\[.*?\]\(.*\)/g)&&!t.hasAttribute("data-img-src")){var a=t.innerText.match("\\((.*)\\)");window.EMDEimagesCache||(window.EMDEimagesCache={});if(a&&a.length>=2){var o=a[1];if(window.EMDEimagesCache[o])assignImageBlockAttributes(t,window.EMDEimagesCache[o]);else{var i=document.createElement("img");i.onload=function(){window.EMDEimagesCache[o]={naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight,url:o};assignImageBlockAttributes(t,window.EMDEimagesCache[o])};i.src=o}}}}))}};EasyMDE.prototype.cleanup=function(){document.removeEventListener("keydown",this.documentOnKeyDown)};function isLocalStorageAvailable(){if("object"!==typeof localStorage)return false;try{localStorage.setItem("smde_localStorage",1);localStorage.removeItem("smde_localStorage")}catch(e){return false}return true}EasyMDE.prototype.autosave=function(){if(isLocalStorageAvailable()){var e=this;if(void 0==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId){console.log("EasyMDE: You must set a uniqueId to use the autosave feature");return}if(true!==this.options.autosave.binded){null!=e.element.form&&void 0!=e.element.form&&e.element.form.addEventListener("submit",(function(){clearTimeout(e.autosaveTimeoutId);e.autosaveTimeoutId=void 0;localStorage.removeItem("smde_"+e.options.autosave.uniqueId)}));this.options.autosave.binded=true}if(true!==this.options.autosave.loaded){if("string"==typeof localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&""!=localStorage.getItem("smde_"+this.options.autosave.uniqueId)){this.codemirror.setValue(localStorage.getItem("smde_"+this.options.autosave.uniqueId));this.options.autosave.foundSavedValue=true}this.options.autosave.loaded=true}var t=e.value();""!==t?localStorage.setItem("smde_"+this.options.autosave.uniqueId,t):localStorage.removeItem("smde_"+this.options.autosave.uniqueId);var a=document.getElementById("autosaved");if(null!=a&&void 0!=a&&""!=a){var o=new Date;var i=new Intl.DateTimeFormat([this.options.autosave.timeFormat.locale,"en-US"],this.options.autosave.timeFormat.format).format(o);var r=void 0==this.options.autosave.text?"Autosaved: ":this.options.autosave.text;a.innerHTML=r+i}}else console.log("EasyMDE: localStorage not available, cannot autosave")};EasyMDE.prototype.clearAutosavedValue=function(){if(isLocalStorageAvailable()){if(void 0==this.options.autosave||void 0==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId){console.log("EasyMDE: You must set a uniqueId to clear the autosave value");return}localStorage.removeItem("smde_"+this.options.autosave.uniqueId)}else console.log("EasyMDE: localStorage not available, cannot autosave")};
/**
 * Open the browse-file window to upload an image to a server.
 * @param [onSuccess] {function} see EasyMDE.prototype.uploadImage
 * @param [onError] {function} see EasyMDE.prototype.uploadImage
 */EasyMDE.prototype.openBrowseFileWindow=function(e,t){var a=this;var o=this.gui.toolbar.getElementsByClassName("imageInput")[0];o.click();function onChange(i){a.options.imageUploadFunction?a.uploadImagesUsingCustomFunction(a.options.imageUploadFunction,i.target.files):a.uploadImages(i.target.files,e,t);o.removeEventListener("change",onChange)}o.addEventListener("change",onChange)};
/**
 * Upload an image to the server.
 *
 * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File)
 * @param [onSuccess] {function} A callback function to execute after the image has been successfully uploaded, with one parameter:
 * - url (string): The URL of the uploaded image.
 * @param [onError] {function} A callback function to execute when the image upload fails, with one parameter:
 * - error (string): the detailed error to display to the user (based on messages from options.errorMessages).
 */EasyMDE.prototype.uploadImage=function(e,t,a){var o=this;t=t||function onSuccess(e){afterImageUploaded(o,e)};function onErrorSup(e){o.updateStatusBar("upload-image",e);setTimeout((function(){o.updateStatusBar("upload-image",o.options.imageTexts.sbInit)}),1e4);a&&"function"===typeof a&&a(e);o.options.errorCallback(e)}function fillErrorMessage(t){var a=o.options.imageTexts.sizeUnits.split(",");return t.replace("#image_name#",e.name).replace("#image_size#",humanFileSize(e.size,a)).replace("#image_max_size#",humanFileSize(o.options.imageMaxSize,a))}if(e.size>this.options.imageMaxSize)onErrorSup(fillErrorMessage(this.options.errorMessages.fileTooLarge));else{var i=new FormData;i.append("image",e);o.options.imageCSRFToken&&i.append("csrfmiddlewaretoken",o.options.imageCSRFToken);var r=new XMLHttpRequest;r.upload.onprogress=function(t){if(t.lengthComputable){var a=""+Math.round(100*t.loaded/t.total);o.updateStatusBar("upload-image",o.options.imageTexts.sbProgress.replace("#file_name#",e.name).replace("#progress#",a))}};r.open("POST",this.options.imageUploadEndpoint);r.onload=function(){try{var e=JSON.parse(this.responseText)}catch(e){console.error("EasyMDE: The server did not return a valid json.");onErrorSup(fillErrorMessage(o.options.errorMessages.importError));return}if(200===this.status&&e&&!e.error&&e.data&&e.data.filePath)t((o.options.imagePathAbsolute?"":window.location.origin+"/")+e.data.filePath);else if(e.error&&e.error in o.options.errorMessages)onErrorSup(fillErrorMessage(o.options.errorMessages[e.error]));else if(e.error)onErrorSup(fillErrorMessage(e.error));else{console.error("EasyMDE: Received an unexpected response after uploading the image."+this.status+" ("+this.statusText+")");onErrorSup(fillErrorMessage(o.options.errorMessages.importError))}};r.onerror=function(e){console.error("EasyMDE: An unexpected error occurred when trying to upload the image."+e.target.status+" ("+e.target.statusText+")");onErrorSup(o.options.errorMessages.importError)};r.send(i)}};
/**
 * Upload an image to the server using a custom upload function.
 *
 * @param imageUploadFunction {Function} The custom function to upload the image passed in options
 * @param file {File} The image to upload, as a HTML5 File object (https://developer.mozilla.org/en-US/docs/Web/API/File).
 */EasyMDE.prototype.uploadImageUsingCustomFunction=function(e,t){var a=this;function onSuccess(e){afterImageUploaded(a,e)}function onError(e){var t=fillErrorMessage(e);a.updateStatusBar("upload-image",t);setTimeout((function(){a.updateStatusBar("upload-image",a.options.imageTexts.sbInit)}),1e4);a.options.errorCallback(t)}function fillErrorMessage(e){var o=a.options.imageTexts.sizeUnits.split(",");return e.replace("#image_name#",t.name).replace("#image_size#",humanFileSize(t.size,o)).replace("#image_max_size#",humanFileSize(a.options.imageMaxSize,o))}e.apply(this,[t,onSuccess,onError])};EasyMDE.prototype.setPreviewMaxHeight=function(){var e=this.codemirror;var t=e.getWrapperElement();var a=t.nextSibling;var o=parseInt(window.getComputedStyle(t).paddingTop);var i=parseInt(window.getComputedStyle(t).borderTopWidth);var r=parseInt(this.options.maxHeight);var n=r+2*o+2*i;var s=n.toString()+"px";a.style.height=s};EasyMDE.prototype.createSideBySide=function(){var e=this.codemirror;var t=e.getWrapperElement();var a=t.nextSibling;if(!a||!/editor-preview-side/.test(a.className)){a=document.createElement("div");a.className="editor-preview-side";if(this.options.previewClass)if(Array.isArray(this.options.previewClass))for(var o=0;o<this.options.previewClass.length;o++)a.className+=" "+this.options.previewClass[o];else"string"===typeof this.options.previewClass&&(a.className+=" "+this.options.previewClass);t.parentNode.insertBefore(a,t.nextSibling)}"undefined"!==typeof this.options.maxHeight&&this.setPreviewMaxHeight();if(false===this.options.syncSideBySidePreviewScroll)return a;var i=false;var r=false;e.on("scroll",(function(e){if(i)i=false;else{r=true;var t=e.getScrollInfo().height-e.getScrollInfo().clientHeight;var o=parseFloat(e.getScrollInfo().top)/t;var n=(a.scrollHeight-a.clientHeight)*o;a.scrollTop=n}}));a.onscroll=function(){if(r)r=false;else{i=true;var t=a.scrollHeight-a.clientHeight;var o=parseFloat(a.scrollTop)/t;var n=(e.getScrollInfo().height-e.getScrollInfo().clientHeight)*o;e.scrollTo(0,n)}};return a};EasyMDE.prototype.createToolbar=function(e){e=e||this.options.toolbar;if(e&&0!==e.length){var t;for(t=0;t<e.length;t++)void 0!=U[e[t]]&&(e[t]=U[e[t]]);var a=document.createElement("div");a.className="editor-toolbar";var o=this;var i={};o.toolbar=e;for(t=0;t<e.length;t++)if(("guide"!=e[t].name||false!==o.options.toolbarGuideIcon)&&(!o.options.hideIcons||-1==o.options.hideIcons.indexOf(e[t].name))&&("fullscreen"!=e[t].name&&"side-by-side"!=e[t].name||!isMobile())){if("|"===e[t]){var r=false;for(var n=t+1;n<e.length;n++)"|"===e[n]||o.options.hideIcons&&-1!=o.options.hideIcons.indexOf(e[n].name)||(r=true);if(!r)continue}(function(e){var t;t="|"===e?createSep():e.children?createToolbarDropdown(e,o.options.toolbarTips,o.options.shortcuts,o):createToolbarButton(e,true,o.options.toolbarTips,o.options.shortcuts,"button",o);i[e.name||e]=t;a.appendChild(t);if("upload-image"===e.name){var r=document.createElement("input");r.className="imageInput";r.type="file";r.multiple=true;r.name="image";r.accept=o.options.imageAccept;r.style.display="none";r.style.opacity=0;a.appendChild(r)}})(e[t])}o.toolbar_div=a;o.toolbarElements=i;var s=this.codemirror;s.on("cursorActivity",(function(){var e=getState(s);for(var t in i)(function(t){var a=i[t];e[t]?a.className+=" active":"fullscreen"!=t&&"side-by-side"!=t&&(a.className=a.className.replace(/\s*active\s*/g,""))})(t)}));var l=s.getWrapperElement();l.parentNode.insertBefore(a,l);return a}};EasyMDE.prototype.createStatusbar=function(e){e=e||this.options.status;var t=this.options;var a=this.codemirror;if(e&&0!==e.length){var o=[];var i,r,n,s;for(i=0;i<e.length;i++){r=void 0;n=void 0;s=void 0;if("object"===typeof e[i])o.push({className:e[i].className,defaultValue:e[i].defaultValue,onUpdate:e[i].onUpdate,onActivity:e[i].onActivity});else{var l=e[i];if("words"===l){s=function(e){e.innerHTML=wordCount(a.getValue())};r=function(e){e.innerHTML=wordCount(a.getValue())}}else if("lines"===l){s=function(e){e.innerHTML=a.lineCount()};r=function(e){e.innerHTML=a.lineCount()}}else if("cursor"===l){s=function(e){e.innerHTML="0:0"};n=function(e){var t=a.getCursor();e.innerHTML=t.line+":"+t.ch}}else"autosave"===l?s=function(e){void 0!=t.autosave&&true===t.autosave.enabled&&e.setAttribute("id","autosaved")}:"upload-image"===l&&(s=function(e){e.innerHTML=t.imageTexts.sbInit});o.push({className:l,defaultValue:s,onUpdate:r,onActivity:n})}}var d=document.createElement("div");d.className="editor-statusbar";for(i=0;i<o.length;i++){var c=o[i];var g=document.createElement("span");g.className=c.className;"function"===typeof c.defaultValue&&c.defaultValue(g);"function"===typeof c.onUpdate&&this.codemirror.on("update",function(e,t){return function(){t.onUpdate(e)}}(g,c));"function"===typeof c.onActivity&&this.codemirror.on("cursorActivity",function(e,t){return function(){t.onActivity(e)}}(g,c));d.appendChild(g)}var u=this.codemirror.getWrapperElement();u.parentNode.insertBefore(d,u.nextSibling);return d}};EasyMDE.prototype.value=function(e){var t=this.codemirror;if(void 0===e)return t.getValue();t.getDoc().setValue(e);if(this.isPreviewActive()){var a=t.getWrapperElement();var o=a.lastChild;o.innerHTML=this.options.previewRender(e,o)}return this};EasyMDE.toggleBold=toggleBold;EasyMDE.toggleItalic=toggleItalic;EasyMDE.toggleStrikethrough=toggleStrikethrough;EasyMDE.toggleBlockquote=toggleBlockquote;EasyMDE.toggleHeadingSmaller=toggleHeadingSmaller;EasyMDE.toggleHeadingBigger=toggleHeadingBigger;EasyMDE.toggleHeading1=toggleHeading1;EasyMDE.toggleHeading2=toggleHeading2;EasyMDE.toggleHeading3=toggleHeading3;EasyMDE.toggleCodeBlock=toggleCodeBlock;EasyMDE.toggleUnorderedList=toggleUnorderedList;EasyMDE.toggleOrderedList=toggleOrderedList;EasyMDE.cleanBlock=cleanBlock;EasyMDE.drawLink=drawLink;EasyMDE.drawImage=drawImage;EasyMDE.drawUploadedImage=drawUploadedImage;EasyMDE.drawTable=drawTable;EasyMDE.drawHorizontalRule=drawHorizontalRule;EasyMDE.undo=undo;EasyMDE.redo=redo;EasyMDE.togglePreview=togglePreview;EasyMDE.toggleSideBySide=toggleSideBySide;EasyMDE.toggleFullScreen=toggleFullScreen;EasyMDE.prototype.toggleBold=function(){toggleBold(this)};EasyMDE.prototype.toggleItalic=function(){toggleItalic(this)};EasyMDE.prototype.toggleStrikethrough=function(){toggleStrikethrough(this)};EasyMDE.prototype.toggleBlockquote=function(){toggleBlockquote(this)};EasyMDE.prototype.toggleHeadingSmaller=function(){toggleHeadingSmaller(this)};EasyMDE.prototype.toggleHeadingBigger=function(){toggleHeadingBigger(this)};EasyMDE.prototype.toggleHeading1=function(){toggleHeading1(this)};EasyMDE.prototype.toggleHeading2=function(){toggleHeading2(this)};EasyMDE.prototype.toggleHeading3=function(){toggleHeading3(this)};EasyMDE.prototype.toggleCodeBlock=function(){toggleCodeBlock(this)};EasyMDE.prototype.toggleUnorderedList=function(){toggleUnorderedList(this)};EasyMDE.prototype.toggleOrderedList=function(){toggleOrderedList(this)};EasyMDE.prototype.cleanBlock=function(){cleanBlock(this)};EasyMDE.prototype.drawLink=function(){drawLink(this)};EasyMDE.prototype.drawImage=function(){drawImage(this)};EasyMDE.prototype.drawUploadedImage=function(){drawUploadedImage(this)};EasyMDE.prototype.drawTable=function(){drawTable(this)};EasyMDE.prototype.drawHorizontalRule=function(){drawHorizontalRule(this)};EasyMDE.prototype.undo=function(){undo(this)};EasyMDE.prototype.redo=function(){redo(this)};EasyMDE.prototype.togglePreview=function(){togglePreview(this)};EasyMDE.prototype.toggleSideBySide=function(){toggleSideBySide(this)};EasyMDE.prototype.toggleFullScreen=function(){toggleFullScreen(this)};EasyMDE.prototype.isPreviewActive=function(){var e=this.codemirror;var t=e.getWrapperElement();var a=t.lastChild;return/editor-preview-active/.test(a.className)};EasyMDE.prototype.isSideBySideActive=function(){var e=this.codemirror;var t=e.getWrapperElement();var a=t.nextSibling;return/editor-preview-active-side/.test(a.className)};EasyMDE.prototype.isFullscreenActive=function(){var e=this.codemirror;return e.getOption("fullScreen")};EasyMDE.prototype.getState=function(){var e=this.codemirror;return getState(e)};EasyMDE.prototype.toTextArea=function(){var e=this.codemirror;var t=e.getWrapperElement();var a=t.parentNode;if(a){this.gui.toolbar&&a.removeChild(this.gui.toolbar);this.gui.statusbar&&a.removeChild(this.gui.statusbar);this.gui.sideBySide&&a.removeChild(this.gui.sideBySide)}a.parentNode.insertBefore(t,a);a.remove();e.toTextArea();if(this.autosaveTimeoutId){clearTimeout(this.autosaveTimeoutId);this.autosaveTimeoutId=void 0;this.clearAutosavedValue()}};I=EasyMDE;var $=I;export default $;

